DROP TABLE IF EXISTS BKPF_BSEG;

CREATE TABLE BKPF_BSEG AS
SELECT
  -- Case Key (based on BSEG)
  BSEG.MANDT || BSEG.BUKRS || BSEG.BELNR || BSEG.GJAHR || BSEG.BUZEI AS _CASE_KEY,

  -- All BKPF fields (prefix BKPF_)
  BKPF.MANDT AS BKPF_MANDT,
  BKPF.BUKRS AS BKPF_BUKRS,
  BKPF.BELNR AS BKPF_BELNR,
  BKPF.GJAHR AS BKPF_GJAHR,
  BKPF.BLART,
  BKPF.BLDAT,
  BKPF.CPUDT,
  BKPF.CPUTM,
  BKPF.BUDAT,
  BKPF.MONAT,
  BKPF.AEDAT,
  BKPF.USNAM,
  BKPF.WAERS AS BKPF_WAERS,
  BKPF.KURSF,
  BKPF.GLVOR,
  BKPF.AWTYP,
  BKPF.AWKEY,
  BKPF.HWAER,
  BKPF.HWAE2,
  BKPF.KURS2,
  BKPF.BASW2,
  BKPF.UMRD2,
  BKPF.CURT2,
  BKPF.KUTY2,
  BKPF.XSNET,
  BKPF.XSTOV,
  BKPF.XMWST,
  BKPF.DOCCAT,
  BKPF.KURST,
  BKPF._CELONIS_CHANGE_DATE AS BKPF_CHANGE_DATE,

  -- All BSEG fields
  BSEG.NUM,
  BSEG.BUKRS AS BSEG_BUKRS,
  BSEG.LIFNR,
  BSEG.AUGBL,
  BSEG.BSCHL,
  BSEG.SHKZG,
  BSEG.MWSKZ,
  BSEG.BELNR AS BSEG_BELNR,
  BSEG.BUZEI,
  BSEG.ZFBDT,
  BSEG.AUGDT,
  BSEG.DMBE2,
  BSEG.WRBTR_CONVERTED,
  BSEG.SKFBT_CONVERTED,
  BSEG.WSKTO_CONVERTED,
  BSEG.MWSTS,
  BSEG.WMWST,
  BSEG.BDIFF,
  BSEG.BDIF2,
  BSEG.PROJN,
  BSEG.AUFNR,
  BSEG.ANLN1,
  BSEG.ANLN2,
  BSEG.EBELN,
  BSEG.EBELP,
  BSEG.SAKNR,
  BSEG.HKONT,
  BSEG.FKONT,
  BSEG.ZTERM,
  BSEG.ZBD1T,
  BSEG.ZBD2T,
  BSEG.ZBD3T,
  BSEG.ZBD1P,
  BSEG.ZBD2P,
  BSEG.SKNTO,
  BSEG.WSKTO,
  BSEG.ZLSPR,
  BSEG.BVTYP,
  BSEG.REBZG,
  BSEG.REBZZ,
  BSEG.SAMNR,
  BSEG.LANDL,
  BSEG.ANFBJ,
  BSEG.VBUND,
  BSEG.REBZT,
  BSEG.QSZNR,
  BSEG.QSFBT,
  BSEG.PROJK,
  BSEG.AUFPL,
  BSEG.APLZL,
  BSEG.XRAGL,
  BSEG.UZAWE,
  BSEG.KZBTR,
  BSEG.LNRAN,
  BSEG.PSWSL,
  BSEG.ZEKKN,
  BSEG.PRCTR,
  BSEG.DTWS1,
  BSEG.DTWS2,
  BSEG.DTWS3,
  BSEG.DTWS4,
  BSEG.PPDIF2,
  BSEG.PPDIF3,
  BSEG.PENLC1,
  BSEG.PENLC2,
  BSEG.PENLC3,
  BSEG.PENFC,
  BSEG.PENDAYS,
  BSEG.KBLPOS,
  BSEG.AUGGJ,
  BSEG.CASE_TYPE,
  BSEG.CASHDISCOUNT20,
  BSEG.CASHDISCOUNT10,
  BSEG.CASHDISCOUNT05,
  BSEG.PENALTY,         
  BSEG._CELONIS_CHANGE_DATE AS BSEG_CHANGE_DATE       

FROM BSEG
LEFT JOIN BKPF
  ON BSEG.MANDT = BKPF.MANDT
 AND BSEG.BUKRS = BKPF.BUKRS
 AND BSEG.BELNR = BKPF.BELNR
 AND BSEG.GJAHR = BKPF.GJAHR;


select * from BKPF_BSEG;
